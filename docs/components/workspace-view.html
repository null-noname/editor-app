<div class="workspace-header">
    <div class="workspace-back-row">
        <button id="editor-back-to-top" class="btn-retro" onclick="closeWorkspace()">TOPÁîªÈù¢„Å´Êàª„Çã</button>
    </div>
    <div class="workspace-tabs-container">
        <button id="tab-info" class="ws-tab" onclick="switchWorkspaceTab('info')">‰ΩúÂìÅÊÉÖÂ†±</button>
        <button id="tab-editor" class="ws-tab active" onclick="switchWorkspaceTab('editor')">Âü∑Á≠Ü</button>
        <button id="tab-memo" class="ws-tab" onclick="switchWorkspaceTab('memo')">„É°„É¢</button>
    </div>
</div>

<div class="workspace-main">
    <!-- Tab: Editor (New 2-Column Layout) -->
    <div id="ws-content-editor" class="workspace-tab-content active">
        <div class="editor-layout-container">
            <!-- Left Sidebar: Chapter List text-based -->
            <div id="chapter-sidebar" class="editor-sidebar-panel">
                <div class="sidebar-top-metric">
                    <span class="label">ÂêàË®à(Á¥î)</span>
                    <span id="metric-total-pure" class="value">0</span>
                </div>

                <div id="chapter-list-container" class="sidebar-list-container">
                    <!-- Dynamic List -->
                    <div class="empty-state">Ë©±„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                </div>

                <div class="sidebar-footer-action">
                    <button class="btn-retro full-width" onclick="window.chapterManager.addChapter()">Ôºã Ë©±„ÇíËøΩÂä†</button>
                </div>
            </div>

            <!-- Right Main: Editor Area -->
            <div id="editor-area" class="editor-main-panel">
                <div class="editor-area-header">
                    <input type="text" id="chapter-subtitle" class="input-retro subtitle-input"
                        placeholder="„Çµ„Éñ„Çø„Ç§„Éà„É´ (‰æã: Á¨¨1Ë©± ÊóÖÁ´ã„Å°)">
                    <div class="header-actions-row">
                        <div class="actions-left">
                            <button class="btn-retro save" onclick="saveCurrentChapter()">‰øùÂ≠ò</button>
                        </div>
                        <div class="actions-center">
                            <button class="btn-retro" onclick="insertRuby()">„É´„Éì</button>
                            <button class="btn-retro" onclick="insertDash()">„ÉÄ„ÉÉ„Ç∑„É•</button>
                        </div>
                        <div class="actions-right">
                            <button class="btn-retro" onclick="document.execCommand('undo')">Êàª„Çã</button>
                            <button class="btn-retro" onclick="document.execCommand('redo')">ÈÄ≤„ÇÄ</button>
                            <button class="btn-retro" onclick="toggleVerticalMode()">Á∏¶/Ê®™</button>
                            <button class="btn-retro" id="btn-display-settings" title="Ë°®Á§∫Ë®≠ÂÆö">‚öô</button>
                            <button class="btn-retro" id="btn-export" title="„Ç®„ÇØ„Çπ„Éù„Éº„Éà">üì§</button>
                            <button class="btn-retro" id="btn-history">„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó</button>
                        </div>
                    </div>
                </div>

                <!-- Settings Popover -->
                <div id="display-settings-panel" class="settings-popover hidden">
                    <div class="setting-row">
                        <label>„Çµ„Ç§„Éâ„Éê„ÉºË°®Á§∫</label>
                        <input type="checkbox" id="setting-show-sidebar" checked>
                        <span></span>
                    </div>
                    <div class="setting-row">
                        <label>ÊñáÂ≠ó„Çµ„Ç§„Ç∫</label>
                        <input type="range" id="setting-font-size" min="10" max="32" value="16">
                        <span id="val-font-size">16px</span>
                    </div>
                    <div class="setting-row">
                        <label>Ë°åÈñì</label>
                        <input type="range" id="setting-line-height" min="1.0" max="3.0" step="0.1" value="1.8">
                        <span id="val-line-height">1.8</span>
                    </div>
                    <div class="setting-row">
                        <label>„Ç®„Éá„Ç£„ÇøÂπÖ</label>
                        <input type="range" id="setting-editor-width" min="50" max="100" value="100">
                        <span id="val-editor-width">100%</span>
                    </div>
                </div>

                <!-- Export Popover -->
                <div id="export-panel" class="settings-popover hidden" style="width: 200px; right: 60px;">
                    <div class="export-menu">
                        <button class="btn-retro full-width mb-10" id="btn-export-txt">TXT ÂΩ¢Âºè„Åß‰øùÂ≠ò</button>
                        <button class="btn-retro full-width" id="btn-export-pdf">PDF ÂΩ¢Âºè„Åß‰øùÂ≠ò</button>
                    </div>
                </div>

                <!-- History Modal (Full Screen Overlay for Diff) -->
                <div id="history-modal" class="modal-overlay hidden">
                    <div class="modal-content large">
                        <div class="modal-header">
                            <h2>Âü∑Á≠ÜÂ±•Ê≠¥</h2>
                            <button class="btn-icon close-modal">√ó</button>
                        </div>
                        <div class="history-layout">
                            <div class="history-list" id="history-list-container">
                                <!-- List of timestamps -->
                            </div>
                            <div class="history-diff-view" id="history-diff-container">
                                <div class="diff-placeholder">Â∑¶„ÅÆ„É™„Çπ„Éà„Åã„ÇâÂ±•Ê≠¥„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn-retro" id="btn-restore-history" disabled>„Åì„ÅÆÂÜÖÂÆπ„Å´Âæ©ÂÖÉ„Åô„Çã</button>
                        </div>
                    </div>
                </div>

                <div class="editor-area-body">
                    <textarea id="main-editor" placeholder="„Åì„Åì„Åã„ÇâÂü∑Á≠Ü„ÇíÈñãÂßã..."></textarea>
                </div>

                <div class="editor-area-footer">
                    <div class="footer-left">
                        <span id="save-status-msg"></span>
                    </div>
                    <div class="footer-right">
                        <span class="metric-item">Á¥î: <b id="count-pure">0</b></span>
                        <span class="sep">/</span>
                        <span class="metric-item">ÂÖ®: <b id="count-total">0</b></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: Work Information -->
    <div id="ws-content-info" class="workspace-tab-content">
        <div id="ws-info-container" class="info-container-scroll">
        </div>
    </div>

    <!-- Tab: Memos -->
    <div id="ws-content-memo" class="workspace-tab-content">
        <!-- Memo List View -->
        <!-- Memo List View -->
        <!-- Memo List View -->
        <div id="memo-list-view" class="memo-pane-container active-subview">
            <div class="memo-list-header">
                <h2 class="retro-subtitle" style="margin:0;">„É°„É¢‰∏ÄË¶ß</h2>
                <button id="memo-new-btn" class="btn-retro add">ÔºãÊñ∞Ë¶è„É°„É¢</button>
            </div>

            <div id="memo-filter-bar" class="memo-filter-bar">
                <!-- Tag filters will appear here -->
            </div>

            <div id="memo-list-container">
                <!-- Loaded via memo-list.js -->
            </div>
        </div>

        <!-- Memo Edit View -->
        <div id="memo-edit-view" class="memo-edit-pane hidden">
            <div class="memo-edit-header">
                <button class="btn-retro small back"
                    onclick="if(window.plotter_closeMemoEditor) window.plotter_closeMemoEditor()">Ôºú Êàª„Çã</button>
                <h2 class="retro-subtitle centered">„É°„É¢Á∑®ÈõÜ</h2>
                <div class="spacer-60"></div>
            </div>

            <div class="card-retro padded-form">
                <label class="gold-bold">„Çø„Ç§„Éà„É´</label>
                <input type="text" id="memo-title" class="input-retro title" placeholder="„Çø„Ç§„Éà„É´„ÇíÂÖ•Âäõ...">

                <label class="gold-bold">„Çø„Ç∞Ôºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ</label>
                <input type="text" id="memo-tags" class="input-retro tags" placeholder="Ë®≠ÂÆö, ‰∏ñÁïåË¶≥, „Ç¢„Ç§„Éá„Ç¢...">

                <label class="gold-bold">ÂÜÖÂÆπ</label>
                <textarea id="memo-content" class="textarea-retro content auto-resize"
                    placeholder="ÂÜÖÂÆπ„ÇíÂÖ•Âäõ..."></textarea>

                <div class="form-footer">
                    <button class="btn-retro save big">‰øùÂ≠ò</button>
                </div>
            </div>
        </div>
    </div>
</div>